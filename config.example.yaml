# AI Proxy Configuration Example

# Server bind address (default: 127.0.0.1, use 0.0.0.0 to listen on all interfaces)
bind: "127.0.0.1"

# Server listen port
listen: ":8642"

# Default max_tokens value for requests that don't specify one (default: 4096)
# This is used when converting requests to APIs that require max_tokens (e.g., Anthropic)
default_max_tokens: 4096

# Timeout in seconds for upstream requests (default: 60)
# This prevents requests from hanging indefinitely when upstream services are slow or unresponsive
upstream_request_timeout: 60

# Rotating file log configuration (optional)
# If not specified or file is empty, logs go to stdout
log:
  file: ""              # Log file path, empty = stdout (e.g., "/var/log/aiproxy/aiproxy.log")
  max_size: 100         # Max size in MB before rotation (default: 100)
  max_backups: 3        # Max number of old files to keep (default: 3)
  max_age: 28           # Max days to retain old files (default: 28)
  compress: false       # Compress rotated files with gzip (default: false)

# Upstream services configuration
# Requests are load-balanced using weighted round-robin
# On 4xx/5xx errors, the next upstream is automatically tried
upstreams:
  - name: "runanytime"
    base_url: "https://runanytime.hxi.me"
    token: "sk-"
    weight: 10
    api_type: "anthropic"
    enabled: false
    # Heartbeat keepalive configuration (optional)
    # Sends a minimal request ("hi") to the upstream at regular intervals to keep the connection alive
    heartbeat: false          # Enable heartbeat (default: false)
    heartbeat_interval: 300   # Heartbeat interval in seconds (default: 0, disabled). Recommended: 300 (5 minutes)
    # Model name mappings for this upstream
    # Key: client model name, Value: upstream model name
    model_mappings:
      "claude-haiku-4-5": "claude-haiku-4-5-20251001"
      "claude-haiku-4-5-thinking": "claude-haiku-4-5-20251001-thinking"
      "claude-opus-4-5": "claude-opus-4-5-20251101"
      "claude-opus-4-5-thinking": "claude-opus-4-5-20251101-thinking"
      "claude-sonnet-4-5": "claude-sonnet-4-5-20250929"
      "claude-sonnet-4-5-thinking": "claude-sonnet-4-5-20250929-thinking"
    # Available models (client model names, i.e., keys in model_mappings)
    # Only requests for these models will be routed to this upstream
    # If not specified, all models are accepted
    available_models:
      - "claude-haiku-4-5"
      - "claude-haiku-4-5-thinking"
      - "claude-sonnet-4-5"
      - "claude-sonnet-4-5-thinking"
      - "claude-opus-4-5"
      - "claude-opus-4-5-thinking"

  - name: "HotaruAPI"
    base_url: "https://api.hotaruapi.top"
    token: "sk-"
    weight: 5
    api_type: "anthropic"
    model_mappings:
      "claude-haiku-4-5": "claude-haiku-4-5-20251001"
      "claude-opus-4-5": "claude-opus-4-5-20251101"
      "claude-sonnet-4-5": "claude-sonnet-4-5-20250929"
      "claude-sonnet-4-5-thinking": "claude-sonnet-4-5-20250929-thinking"
    available_models:
      - "claude-haiku-4-5"
      - "claude-sonnet-4-5"
      - "claude-sonnet-4-5-thinking"
      - "claude-opus-4-5"

  - name: "Nyxar API"
    base_url: "https://api.nyxar.org"
    token: "sk-"
    weight: 5
    api_type: "anthropic"
    model_mappings:
      "claude-haiku-4-5": "claude-haiku-4-5-20251001"
      "claude-opus-4-5": "claude-opus-4-5-20251101"
      "claude-sonnet-4-5": "claude-sonnet-4-5-20250929"
    available_models:
      - "claude-haiku-4-5"
      - "claude-sonnet-4-5"
      - "claude-opus-4-5"
      
  - name: "Huan API"
    base_url: "https://ai.huan666.de"
    token: "sk-"
    weight: 1
    api_type: "anthropic"
    model_mappings:
      "claude-haiku-4-5": "claude-haiku-4-5-20251001"
      "claude-sonnet-4-5": "claude-sonnet-4-5-20250929"
    available_models:
      - "claude-haiku-4-5"
      - "claude-sonnet-4-5"

  - name: "123nhh"
    base_url: "https://new.123nhh.xyz"
    token: "sk-"
    weight: 1
    api_type: "anthropic"
    model_mappings:
      "claude-opus-4-5-thinking": "gemini-claude-opus-4-5-thinking"
      "claude-sonnet-4-5": "gemini-claude-sonnet-4-5"
    available_models:
      - "claude-opus-4-5-thinking"
      - "claude-sonnet-4-5"
      
  - name: "鸢北的公益站"
    base_url: "https://api.nlvps.hidns.co"
    token: "sk-"
    weight: 10
    api_type: "anthropic"
    model_mappings:
      "claude-sonnet-4-5": "claude-sonnet-4-5-20250929"
    available_models:
      - "claude-sonnet-4-5"
                  
  - name: "黑与白"
    base_url: "https://ai.hybgzs.com/claude"
    token: "sk-"
    weight: 5
    api_type: "anthropic"
    available_models:
      - "claude-opus-4.6"
      - "claude-opus-4.6-think"                     
      
  - name: "摸鱼公益"
    base_url: "https://clove.cc.cd"
    token: "sk-"
    weight: 5
    api_type: "anthropic"
    available_models:
      - "claude-opus-4.6"
      - "claude-sonnet-4.5"
                                 
  - name: "elysiver"
    base_url: "https://elysiver.h-e.top"
    token: "sk-"
    weight: 5
    api_type: "anthropic"       
    model_mappings:
      "claude-sonnet-4-5": "claude-4.5-sonnet-real"
    available_models:
      - "claude-sonnet-4-5"       
      
  - name: "FreeDuckCoding"
    base_url: "https://free.duckcoding.com"
    token: "sk-"
    weight: 5
    api_type: "anthropic"
    model_mappings:
      "claude-sonnet-4-5-thinking": "claude-sonnet-4-5-20250929-thinking"       
      "claude-sonnet-4-5": "claude-sonnet-4-5-20250929"
      "claude-haiku-4-5": "claude-haiku-4-5-20251001"
    available_models:
      - "claude-haiku-4-5"
      - "claude-sonnet-4-5"
      - "claude-sonnet-4-5-thinking"
      
      
  # Example OpenAI-compatible upstream
  # Use api_type: "openai" for OpenAI-compatible services
  - name: "OpenAI Compatible"
    base_url: "https://api.openai.com"
    token: "sk-your-openai-key"
    weight: 5
    enabled: false
    api_type: "openai"  # Use OpenAI API format (Authorization: Bearer header, /v1/chat/completions endpoint)
    model_mappings:
      "gpt-4": "gpt-4-turbo"
      "gpt-4o": "gpt-4o-2024-11-20"
    available_models:
      - "gpt-4"
      - "gpt-4o"

  # Example OpenAI upstream with native Responses API support
  # Use api_type: "responses" for native /v1/responses endpoint
  - name: "OpenAI Responses"
    base_url: "https://api.openai.com"
    token: "sk-your-openai-key"
    weight: 5
    enabled: false
    api_type: "responses"  # Use native Responses API format (/v1/responses endpoint)
    model_mappings:
      "gpt-4o": "gpt-4o-2024-11-20"
    available_models:
      - "gpt-4o"

  # Example Gemini upstream
  # Use api_type: "gemini" for Google Gemini API
  - name: "Google Gemini"
    base_url: "https://generativelanguage.googleapis.com"
    token: "your-gemini-api-key"
    weight: 5
    enabled: false
    api_type: "gemini"  # Use Gemini API format (API key auth, /v1beta/models endpoint)
    model_mappings:
      "gemini-pro": "gemini-1.5-pro"
      "gemini-flash": "gemini-1.5-flash"
    available_models:
      - "gemini-pro"
      - "gemini-flash"

  # Example Codex upstream (ChatGPT Code Assist with OAuth)
  # Use api_type: "codex" for ChatGPT Codex API
  - name: "ChatGPT Codex"
    weight: 5
    enabled: false
    api_type: "codex"  # Use Codex API format (OAuth, chatgpt.com/backend-api/codex/responses)
    # For OAuth-based upstreams, use auth_files instead of token
    # Multiple auth files will be used in round-robin fashion
    auth_files:
      - "/path/to/codex-auth1.json"
      - "/path/to/codex-auth2.json"
    model_mappings:
      "codex-pro": "gpt-4o"
    available_models:
      - "codex-pro"

  # Example Gemini CLI upstream (Google Cloud Code Assist with OAuth)
  # Use api_type: "geminicli" for Gemini CLI API
  - name: "Gemini CLI"
    weight: 5
    enabled: false
    api_type: "geminicli"  # Use Gemini CLI API format (OAuth, cloudcode-pa.googleapis.com)
    # For OAuth-based upstreams, use auth_files instead of token
    auth_files:
      - "/path/to/geminicli-auth1.json"
      - "/path/to/geminicli-auth2.json"
    model_mappings:
      "gemini-3-pro": "gemini-3-pro-preview"
      "gemini-3-flash": "gemini-3-flash-preview"
    available_models:
      - "gemini-3-pro"
      - "gemini-3-flash"

  # Example Antigravity upstream (Google Antigravity with OAuth)
  # Use api_type: "antigravity" for Antigravity API
  - name: "Antigravity"
    weight: 5
    enabled: false
    api_type: "antigravity"  # Use Antigravity API format (OAuth, daily-cloudcode-pa.googleapis.com)
    auth_files:
      - "/path/to/antigravity-auth1.json"
      - "/path/to/antigravity-auth2.json"
    model_mappings:
      "gemini-3-pro": "gemini-3-pro-high"
      "claude-opus-4-6": "claude-opus-4-6-thinking"
    available_models:
      - "gemini-3-pro"
      - "claude-opus-4-6"

  # Example Claude Code upstream (Anthropic Claude Code with OAuth)
  # Use api_type: "claudecode" for Claude Code API
  - name: "Claude Code"
    weight: 5
    enabled: false
    api_type: "claudecode"  # Use Claude Code API format (OAuth, api.anthropic.com)
    auth_files:
      - "/path/to/claudecode-auth1.json"
      - "/path/to/claudecode-auth2.json"
    model_mappings:
      "claude-opus-4-6": "claude-opus-4-6"
      "claude-sonnet-4-6": "claude-sonnet-4-6"
    available_models:
      - "claude-opus-4-6"
      - "claude-sonnet-4-6"

